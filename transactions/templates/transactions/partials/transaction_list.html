{% load humanize %}
<p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
  History for {{ content_type.model }} #{{ object_id }}. Click a row to see details.
</p>
<div class="overflow-x-auto max-h-[60vh] overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-lg">
  <table class="min-w-full text-sm">
    <thead class="bg-gray-100 dark:bg-gray-700 sticky top-0">
      <tr>
        <th class="text-left py-2 px-3 text-gray-700 dark:text-gray-300">Date / time</th>
        <th class="text-left py-2 px-3 text-gray-700 dark:text-gray-300">User</th>
        <th class="text-left py-2 px-3 text-gray-700 dark:text-gray-300">Field</th>
        <th class="text-left py-2 px-3 text-gray-700 dark:text-gray-300">Old → New</th>
      </tr>
    </thead>
    <tbody>
      {% for tx in transactions %}
      <tr
        class="border-t border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer"
        onclick="showTransactionDetail({{ tx.pk }})"
      >
        <td class="py-2 px-3 text-gray-700 dark:text-gray-300">{{ tx.created_at|date:"M j, Y g:i A" }}</td>
        <td class="py-2 px-3">{{ tx.user.get_full_name|default:tx.user.username|default:"—" }}</td>
        <td class="py-2 px-3 font-medium">{{ tx.field_name }}</td>
        <td class="py-2 px-3">
          <span class="text-gray-500 line-through">{{ tx.old_value|truncatewords:8|default:"—" }}</span>
          <span class="mx-1">→</span>
          <span>{{ tx.new_value|truncatewords:8|default:"—" }}</span>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="py-6 px-3 text-center text-gray-500 dark:text-gray-400">No changes recorded yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
