{% extends 'training/training_base.html' %}
{% load static %}
{% load training_filters %}

{% block body %}
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Arctic Wolf Training Courses</h1>
        <ul>
            {% for course in courses %}
                <li class="flex items-center justify-between py-2 border-b border-gray-200">
                    <span>{{ course.name }}</span>
                    <div>
                        <a href="{{ full_links|get_item:course.slug }}" target="_blank" class="text-blue-500 hover:underline mr-2">View Link</a>
                        <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline"
                                onclick="copyLink('{{ full_links|get_item:course.slug }}')">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M8 5a2 2 0 002-2h4a2 2 0 012 2M8 5a2 2 0 012-2h4a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 3H10m0 0h6m0 0v6" />
                            </svg>
                            <span class="sr-only">Copy Link</span>
                        </button>
                    </div>
                </li>
            {% empty %}
                <li>No Arctic Wolf courses have been added yet.</li>
            {% endfor %}
        </ul>
        <div class="mt-4">
            <a href="{% url 'training:add_arctic_wolf_course' %}" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Add New Course</a>
        </div>
    </div>

    <script>
        function copyLink(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    alert('Link copied to clipboard!');
                }, function(err) {
                    console.error('Could not copy text: ', err);
                    alert('Could not copy link. Please copy it manually.');
                });
            } else {
                var textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    var successful = document.execCommand('copy');
                    var msg = successful ? 'successful' : 'unsuccessful';
                    alert('Link copied to clipboard!');
                } catch (err) {
                    console.error('Could not copy text: ', err);
                    alert('Could not copy link. Please copy it manually.');
                }
                document.body.removeChild(textArea);
            }
        }
    </script>
{% endblock %}